```{r}
library(rvest)
library(dplyr)

whales_html <- read_html('http://dcs.whoi.edu/mdoc0722/mdoc0722_mdoc.shtml') 

whales <- whales_html |> 
  html_element(xpath = '/html/body/table[1]') |> 
  html_table()


colors <- whales_html |> 
  html_elements(xpath = '/html/body/table[1]/tr/td')|> 
  html_attr('style')

colors <- colors[grepl('background', colors)]

colors <- gsub('background-color:', '', colors)
head(matrix(colors, ncol = 4, byrow = T))

whales[, 2:5] <- matrix(colors, ncol = 4, byrow = T)



whales |>
  mutate(
    across(
      everything(),
      ~ case_when(. == 'lightgray' ~ 'not detected',
                  . == 'yellow' ~ 'possibly detected',
                  . == 'red' ~ 'detected',
                  T ~ .)
    ),
    Date = as.Date(Date, format = '%m/%d/%Y')
  )
```


![](images/NARW.png)

North Atlantic right whale (Eubalaena glacialis)\
Current Status of population: Critically Endangered species\
Visit the [North Atlantic right whale page](https://www.fisheries.noaa.gov/species/north-atlantic-right-whale) on NOAA's website for more information.

![](images/Finwhale.png)

Fin whale (Balaenoptera physalus)\
Current Status of population: Endangered species\
Visit the [fin whale page](https://www.fisheries.noaa.gov/species/fin-whale) on NOAA's website for more information.

![](images/Humpbackwhale.png)

Humpback whale (Megaptera novaeangliae)\
Current status of population: Protected species\
Visit the humpback whale page on NOAA's website for more information.
